(()=>{"use strict";const e=document.querySelector("#show-popup"),t=document.querySelector(".popup_type_edit"),s=document.querySelector(".popup_type_new"),n=document.querySelector("#show-popup-new"),r=document.querySelector("#name"),o=document.querySelector("#job"),i=document.querySelector(".template"),l={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"};class u{constructor(e,t,s,n){this._text=e,this._link=t,this._cardSelector=s,this._handleCardClick=n}_getTemplate(){return document.querySelector(".template").content.querySelector(".element").cloneNode(!0)}generateCard(){return this._element=this._getTemplate(),this._setEventListeners(),this._element.querySelector(".element__image").src=this._link,this._element.querySelector(".element__image").alt=this._text,this._element.querySelector(".element__title").textContent=this._text,this._element}_setEventListeners(){this._element.querySelector(".element__button").addEventListener("click",(()=>{this._handleLikeIcon()})),this._element.querySelector(".element__button_delete").addEventListener("click",(()=>{this._handleDeleteButton()})),this._element.querySelector(".element__image").addEventListener("click",(()=>{this._handleCardClick()}))}_handleLikeIcon(){this._element.querySelector(".element__button").classList.toggle("element__button_theme-dark")}_handleDeleteButton(){this._element.remove()}}function p(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class c{constructor(e,t){p(this,"_allInputsEmpty",(()=>!this._inputList.some((e=>e.value.length>0)))),p(this,"_hasInvalidInput",(()=>this._inputList.some((e=>!e.validity.valid)))),p(this,"activeFormButton",(()=>{this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.removeAttribute("disabled")})),p(this,"inActiveFormButton",(()=>{this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.setAttribute("disabled",!0)})),p(this,"_toggleButtonState",(()=>{this._hasInvalidInput(this._inputList)||this._allInputsEmpty(this._inputList)?this.inActiveFormButton():this.activeFormButton()})),p(this,"_showInputError",(e=>{this._errorElement=this._element.querySelector("#".concat(e.id,"-error")),e.classList.add(this._inputErrorClass),this._errorElement.textContent=e.validationMessage,this._errorElement.classList.add(this._errorClass)})),p(this,"_hideInputError",(e=>{this._errorElement=this._element.querySelector("#".concat(e.id,"-error")),e.classList.remove(this._inputErrorClass),this._errorElement.classList.remove(this._errorClass)})),p(this,"_checkInput",(e=>{e.validity.valid?this._hideInputError(e):this._showInputError(e)})),p(this,"_setInputListeners",(()=>{this._inputList=Array.from(this._element.querySelectorAll(this._inputSelector)),this._buttonElement=this._element.querySelector(this._submitButtonSelector),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInput(e),this._toggleButtonState()})),this._toggleButtonState()}))})),this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._element=t}enableValidation(){this._element.addEventListener("submit",(function(e){e.preventDefault()})),this._setInputListeners()}}class a{constructor(e){this._popup=document.querySelector(e),this._handleEscPress=this._handleEscPress.bind(this)}setEventListeners(){this._popup.querySelector(".popup__close").addEventListener("click",(()=>this.close())),this._popup.addEventListener("click",(e=>{e.target.classList.contains("popup")&&this.close()}))}open(){this._popup.classList.add("popup_open"),document.addEventListener("keydown",this._handleEscPress)}close(){this._popup.classList.remove("popup_open"),document.removeEventListener("keydown",this._handleEscPress)}_handleEscPress(e){"Escape"===e.key&&this.close()}}class _ extends a{constructor(e,t){super(e),this._submitForm=t,this._popupForm=this._popup.querySelector(".popup__form"),this._inputItems=this._popupForm.querySelectorAll(".popup__input")}_getInputValues(){return this._newValues={},this._inputItems.forEach((e=>{this._newValues[e.name]=e.value})),this._newValues}removeInputValue(){this._popupForm.querySelectorAll(".popup__input").forEach((e=>{e.value=""}))}setEventListeners(){this._popup.addEventListener("submit",(e=>{e.preventDefault(),this._submitForm(this._getInputValues())})),super.setEventListeners()}close(){super.close(),this.removeInputValue()}}function h(e,t,s){return new u(e,t,s,(()=>{m.open({name:e,link:t})}))}const d=new class{constructor(e,t){let{items:s,renderer:n}=e;this._items=s,this._renderer=n,this._containerSelector=document.querySelector(t)}addItem(e,t){const s=t?"append":"prepend";this._containerSelector[s](e)}rendererItems(){this._items.forEach((e=>{this._renderer(e)}))}}({items:[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],renderer:function(e){const t=h(e.name,e.link,".template").generateCard();d.addItem(t)}},".elements__list");d.rendererItems();const m=new class extends a{constructor(e){super(e)}open(e){let{link:t,name:s}=e;const n=this._popup.querySelector(".popup__img");this._popup.querySelector(".popup__caption").textContent=s,n.src=t,n.alt=s,super.open()}}(".popup_type_image");m.setEventListeners();const v=new class{constructor(e,t){this._userName=document.querySelector(e),this._userJob=document.querySelector(t)}getUserInfo(){return this._userInfo={},this._userInfo.name=this._userName.textContent,this._userInfo.job=this._userJob.textContent,this._userInfo}setUserInfo(e,t){this._userName.textContent=e,this._userJob.textContent=t,console.log(this._userName),console.log(this._userJob)}}(".profile__title",".profile__subtitle"),y=new _(".popup_type_edit",(e=>{console.log(e);const t={name:e.name,job:e.job};v.setUserInfo(t.name,t.job),y.close()}));y.setEventListeners();const E=new _(".popup_type_new",(e=>{console.log(e);const t={name:e.place,link:e.link},s=h(t.name,t.link,i).generateCard();d.addItem(s),E.close()}));E.setEventListeners(),n.addEventListener("click",(()=>{E.open()})),e.addEventListener("click",(()=>{const e=v.getUserInfo();r.value=e.name,o.value=e.job,y.open()})),n.addEventListener("click",(()=>{E.open()}));const b=new c(l,t),S=new c(l,s);b.enableValidation(),S.enableValidation()})();